val input: List<String> = listOf(
"....#...............#.#..###.##",
".#..#....###..............##...",
"....###......#....#.#...#.##..#",
".......#........#..###...##....",
".....#..#......#..#..##..#...#.",
"....#..........#....#...#......",
"............###...#............",
"##......#.....#......#.....##..",
"........#.........##..#.#...##.",
"....#.#..#.#...#........#..#...",
".#.....#.#......#....#..#..#..#",
"#.##..##......#.....##...#..#..",
"#........#..##...###....##.....",
"......#.#..##...#.#.....#......",
"##.......#..#.........#...#....",
".....##.........#....#.#.###.#.",
"..##...........#.#.#.#.....#.#.",
"....#...............#......#.#.",
"#.#..#....#.....#.....##...#..#",
"#......#..............#.#.##...",
"......###.....#...#........###.",
"####...#.....#...#....#........",
".......#...#....##...#.........",
".####..##............#.........",
"#.#...#...#....#...#.#......#..",
"..#..#.....#.......#...#.#...##",
".#.........#...#......##.#...#.",
".#.#...#...#.....#.#........#.#",
".#.....###....###..##.#..##.#..",
".....##....#......#..#...#...#.",
"#...##....#.......#.....##.##..",
"#...#.....#.#...........#..###.",
"##.#........###...........###.#",
"#...#.#........#.#.....#.......",
"..................#..#.........",
".....#.#..#.#......#..#.....##.",
".#.#.......#..##........#..##.#",
".#.#..#.#...#.......#.#.#..#...",
"...#......#....#....##.#..#....",
"......#.......##....##..#.....#",
"...#.##...##...............#..#",
".###....#.#.....##..#.......#.#",
"#....#..........#...........#.#",
"...#...............#.#..#....#.",
".....#..##..........#..###.....",
".....####.....#.#.......#...#..",
"#.............#...#.......##...",
".#....##.......#.#......#.#.##.",
".#..#.......#..##...#...#......",
"#.......#..#..#..#.....#.......",
"##...#.#.#...........#....#....",
".......#..#.#..............#.#.",
".....#.......#.......#.#.#.....",
"....##.##.....#......#.......#.",
"#...#..#.#....###....##...#.#.#",
"#..#......#........#.#.#.....#.",
"###..##..#......#.....#.......#",
"..##....#.#.#......#..##...#...",
".....#..#....#...#.#...#...#...",
".....#.#..###.#..#...##......#.",
"#.#..#....#..#.....#.#...#.#...",
".#..#....#.......#..#.......#..",
"#.........#..#..#.........##..#",
"..##.##..#..#...##.............",
".....###...#..#...##.#..#......",
"#.##.....##..............#.....",
".......#.##.#.##...#.#.......##",
"...#.#.##...#......#...........",
"##.#........#.....##.....#.....",
".#.....#.............#......#..",
"....#..##..#..#....#..#.#......",
".#.....#....##..##..#...##.....",
".##........#.#.#.#..........#.#",
"...#.#.#..#....#...#..###.##...",
".#....#....#.#.#.#....#..#.....",
"#.#.......#..#..#...........#.#",
".....#.....##..#....##.........",
"....#.##..............#........",
".................#....#.......#",
"...................###...#...#.",
"...#.#..#..##..##....#.....#...",
"#...#..........................",
".......#..#..#.#..#.....#......",
"..##.#..#......#...#.##..##..#.",
".##.........#.#...........#....",
"...#...#..##.#......#..#..#....",
".....#.#....#...#............#.",
".##..#.....##....#...#.........",
"#......##...#...#............#.",
".....#.##...#.#....##..........",
".............#.......#.#.......",
"##....#.#........#....#..##....",
"....#...##.#....##..#.....#.#..",
"...##..#....##......#...#......",
".####.#..#..#.#...#.#.#....#...",
".#........#.##....#.#....#.....",
".........#....##..#..#.........",
"....##...#....##.............#.",
"....#..##.#....#.#..#...##.....",
".....##...#..#....#......#.#...",
"..........#.......#.##..#.##..#",
".......#.........#...#.##......",
"....##.#.......#...............",
"....#.......#..##.......##.#.##",
"#.#..#.#....#.#.........###...#",
".#.##.....##..##...........#.#.",
"...#....##........##...#...#...",
".#.##....#.#...#.#..#..#...#...",
"#....#.##...#.#..#....#.....#..",
"#..#...#........#...........#..",
"...........#.......#......#..#.",
"....##...#......##.....#......#",
".#.##.#.#.............#....##..",
".#...#...##.#.#........#..##.#.",
".#.#........#.#...#..#........#",
".###.#.#...#..#..#.#....#..#...",
"..##..##....#.#............#...",
"#..........#........#..#.#.#...",
".#...#..#..#.#.....#.....#....#",
"#.....#.#.#.....####.......#...",
"...#.#........#.#.###...#.....#",
".....#.....##....#....#..##...#",
"..#....###.##.#..#..#....#...#.",
".....#.....#...........#.#.###.",
".....#......###...#.#...##.....",
"...........###..#...#....#.#..#",
"...#..###.....#....#.#...#.....",
".......#...#..#..##....#.#.#...",
"...#..####.###........#.....#..",
"..#......###..#..#.##..........",
"....#....##..##..##.......###..",
"...#.......#..#.#....##........",
".#.#.....#.#.#..........#..#..#",
".##....##....##...........##.##",
"........#......#.##....##...#.#",
"..#.#.....#..#....#..........#.",
"...........#...............#...",
".....####.....#.....###.#..#...",
"..........####..##.##.#....#...",
"...#.#.#......#....#..#.#......",
".#.#......###.....#....#.......",
"..#..#..#.......#..#...#.....#.",
"...#............#......##...###",
"......#.............#..#..###..",
".#.#......#..##.#..#..#.#...#.#",
".#.....#.......#..#...........#",
"..#.###.#..#...#.##..#.##......",
"....#.#........#..#.#...#.#.##.",
".#..##.#..#.#.#...##..#.#......",
".......#..#..#..#.....#.#.#..#.",
".##.###..##.....#.##..#........",
"...##..............#.#.##....#.",
"##....#...#...........#........",
"..#........#.#.##..#.#...#..#..",
".......#.......##.#..#....#.#..",
".......#....##..#.#.#..#....#..",
"..........#....#..#..#....#....",
"........#.....#.#.....##.......",
"........##.###.........#.#.#...",
"###......####...#.#........#...",
"......#........#......#.....#..",
"##..#.##..##.###..#........##..",
".#..#...#............##.##..#..",
"...........#..#.#..............",
".##.#.#....#...............#..#",
".........##.................#..",
"#............##..##.........##.",
"##........#.........#..##.#...#",
"........#.....#..#.........#.##",
"....#......#.....##.##.........",
".#.#.....#.#..#..##....#....#..",
".###...#..##....##.....#.#..##.",
".#....#.#.......#..#..#...###..",
"..#.#......#.#..#.....###.....#",
"#....#..#...#.....#.......#.##.",
".#.......##.#.#...#......#.....",
"###....#.#......#....#.#...##..",
"...#....####.......##.....#..#.",
".#.................#.......##.#",
"...#.###..........#..##......#.",
".....##.#..............##..#...",
"#.....#..#..........#..#.......",
"..#...#.#.#.......##.#.....#...",
"#........#.#........#.#.....#..",
"#.....#...##....##..##........#",
".#.##..#...#....#........#..#..",
"#..#.....#....#...##......#....",
"...#...#...#.#.#....##....#.#.#",
"......#...............#.....#..",
".......#.#..#..##.#.....#......",
"...........##......#...#.......",
"....##..##.....#.#...#.........",
"......##..###.......#....#.##..",
"......#..#.##....#..###..#.....",
".....#.........#........##.....",
".....####..................#...",
".#.#...##................#.....",
".#..#...#...#.....#.##..#..#...",
".#................#...###....#.",
"...#....#...........#...#....#.",
".......#....##...............#.",
".#.#.##..##.......#....#....###",
"......#.#....#...#..#..........",
"....#.##.#.#...##.#.#......#...",
"##....#...##.....#..#.###.#....",
".......#......#.........#.#...#",
".##.#...........##.........#.#.",
"##..##.....#...#..#.#...#....#.",
"#..##......###........#...#....",
".....#.#.......#...#..##....##.",
".....#.#..#.....#.......#..##..",
"...#..#..............#.#.......",
".#.#...###......###............",
".....#.....#...#.###...........",
".......#..................#...#",
"#....#...#...#....#....#.#....#",
"....#..#............#.#........",
"#....#..........#.#.#..#..#....",
".......#....#......#....#......",
".##.#.#...#...#...##...........",
".........###.#..#..............",
"...#........##....#....#....###",
"....##..#.......#.#...#.#..#.#.",
".....##....#..##.........#.....",
"........##..#........#.........",
"...........#..#.##..##...#.....",
".........#.#..####..#...#.##.##",
"##..#.#.....##.....#.........#.",
"..#...#...#....#.#....#.....#.#",
".###.#....#.#......#....#......",
".##.....#....#.......#.#..#.##.",
"#..#..##.....#....#...##.....#.",
"...#.........####.........##..#",
"..#.....#....###.#.#...#..#....",
".........#....#..#.#.........#.",
".....###.##..#...#.....#..#..#.",
"....#......#..#.#...#.....#....",
".......#...#..#....#.......#.#.",
".#....#............#....####...",
"#..##..##....#.....#...#.....#.",
"...#...##...#.#....#...........",
".......#####.....#..###.#..#...",
".....#.....#.#....#.........#..",
".###.#..#...##.##.#.#..#..#....",
".#..#.##..#......#..........##.",
"##....#....#.........###..#....",
"..#.............#.......#.#....",
"..#.....#..##...#...###..#.##..",
"##...##...#.#....#..#..........",
"...............#.....#.......#.",
"....#.#......##.#......#...#.#.",
".........#.............#.#.....",
"...#.#.........................",
"..#..#....##..#...###.##.......",
"...##.#...##..#.#.##.#...#.##..",
".##....#....#.......#.....##..#",
".#...............#..#...#......",
"...##.....##.###....#.....#...#",
"...#.....#...####....##....#..#",
"..#.#.###..##.....#........#...",
".....##.##..#..#.........##....",
"........##.....#..........#.##.",
"..##.#....####..#...........#..",
"##....#..#..#.#.##.....#...##..",
"...#...#......#..#.#....#......",
"##.....##.......##.##....#.....",
".........#...##...........#....",
".###.#..#....##...#.....#.....#",
"...#..........#.###..##...#.##.",
"...#..#....#.#.#.......###.....",
"....#..#.#.....##...#.#.#.#....",
".......##..#...##..##.#....#...",
".##..........#.#.#.....#.....#.",
"#....#......##...#..##.#..#..#.",
".#...#.....###..#......#.....#.",
".#..#.###.......#.##....###....",
"#....#....#....#....#..#.##....",
"..#..#.....#.....#....###.....#",
"##.###..#...##.......#.#.......",
"#...##......##....#.#...#....#.",
"..##.#.#....#...#.....##.......",
".#....#..#...#...##..##........",
"###......#.##....#.#..##.......",
"...#.....##.#.........#..#.....",
".......#.#....#.....##......#..",
"#..#..............##.#........#",
"....#.#....#..#.#...##.........",
"..........#..........#.........",
".#.....#.....#.##....#.##..#..#",
".......#.......#.#.#.##....#...",
"..#...........#....#.......##..",
"..#.#.#.#...##..#.#.#..#...#.#.",
"..#..#..........#...##....#....",
"....##.#....#.............#....",
".##...##..........#.#..#...#...",
"#..#..#.##..........##.........",
"............#.......#..#.....##",
"....#......#........#..#.##....",
"#.#......#.#...#.....#.........",
"..#.....#..#..........#.....#..",
".#..#.#.#.##...#..#.#.........#",
"#...##....#..##..#...#.#.##....",
"#..##.##.#.##.......#.......#..",
"#.#.......#........#.##....#.#.",
"....#..##....##..##......#..##.",
"#.....#....#.#........####.....",
"......#...#...###..#...........",
".##.#.##...##................##",
"..##.#.....#.#..#......#.#.....",
"......#...#........#.....#.##..",
"#..#.#..#.....#.#..#..##..#.#..",
"...#.........#.#.#.##...#......",
"...#..##....#..#.#....#.###.#..",
"........###................##.#",
"##...........#......##.##.....#",
".#.#.#....#....#....#..........",
"#.....#........................",
"....#.....#...#......#.........",
"....#.#..#..............#......",
"##.........#..#....#.......#...",
".###....#..#.#.####.........#..",
"..#.#....#.....###..#..........",
"..........#................#.##"
)

var tree = '#'
var currentIndexPart1 = 0
var currentHeightPart1 = 0
var treeCountPart1 = 0

while(currentHeightPart1 < input.size - 1) {
    input[currentHeightPart1][currentIndexPart1].takeIf { it == tree }?.let {
        treeCountPart1++
    }
    currentHeightPart1 += 1
    val maxIndex = input[currentHeightPart1].length
    currentIndexPart1 = (currentIndexPart1 + 3) % maxIndex
}

println("Part 1: $treeCountPart1")


var slopes = listOf(
        Slope(1, 1),
        Slope(3, 1),
        Slope(5, 1),
        Slope(7, 1),
        Slope(1, 2)
)
var currentHeightPart2 = 0
val maxIndex = input[currentHeightPart2].length


while(currentHeightPart2 < input.size) {
    val currentLine = input[currentHeightPart2]
    slopes.forEach { slope ->
        if ((currentHeightPart2 % slope.downwardMovement) == 0) {
            currentLine[slope.currentIndex].takeIf { it == tree }?.let {
                slope.treeCount++
            }
            slope.currentIndex = (slope.currentIndex + slope.sidewaysMovement) % maxIndex
        }
    }
    currentHeightPart2 += 1
}

println("Part 2: ${slopes.multiplyOf { it.treeCount }}")

data class Slope(
        val sidewaysMovement: Int,
        val downwardMovement: Int,
        var currentIndex: Int = 0,
        var treeCount: Int = 0
)

inline fun <T> Iterable<T>.multiplyOf(selector: (T) -> Int): Long {
    var total = 0L
    for (element in this) {
        if (total == 0L) {
            total = selector(element).toLong()
        } else {
            total *= selector(element)
        }
    }
    return total
}
